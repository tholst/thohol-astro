---
import type { CollectionEntry } from 'astro:content';
import BaseLayout from './BaseLayout.astro';
import FormattedDate from '../components/FormattedDate.astro';

type Props = CollectionEntry<'blog'>['data'];

const { title, description, pubDate, updatedDate, heroImage } = Astro.props;
---

<BaseLayout title={title} description={description}>
  <main>
    <article class="prose post-prose">
      <a class="back-link" href="/blog/">← Back to archive</a>

      <header class="post-header">
        <p class="meta">
          <FormattedDate date={pubDate} />
          {
            updatedDate && (
              <>
                {' · Updated '}
                <FormattedDate date={updatedDate} />
              </>
            )
          }
        </p>
        <h1>{title}</h1>
        <p class="dek">{description}</p>
      </header>

      {
        heroImage && (
          <figure class="hero-image">
            <img
              src={heroImage.src}
              width={heroImage.width}
              height={heroImage.height}
              alt=""
            />
          </figure>
        )
      }

      <slot />
    </article>
  </main>
</BaseLayout>

<style>
  .back-link {
    display: inline-block;
    margin-bottom: 0.85rem;
    color: var(--ink-soft);
    text-decoration: none;
    font-family: var(--font-mono);
    font-size: 0.86rem;
  }

  .post-header {
    border-bottom: 1px solid var(--line);
    padding-bottom: 1rem;
    margin-bottom: 1.2rem;
  }

  .meta {
    margin: 0;
    font-size: 0.8rem;
    color: var(--ink-soft);
    font-family: var(--font-mono);
  }

  .dek {
    margin: 0;
    color: var(--ink-soft);
    max-width: 64ch;
  }

  .hero-image {
    margin: 0 0 1rem;
  }

  .hero-image img {
    width: 100%;
    border-radius: 8px;
    border: 1px solid var(--line);
    height: auto;
  }
</style>
